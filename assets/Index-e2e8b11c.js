import{_ as G,a0 as J,u as Q,o as W,r as v,a as X,h as Y,b as r,c as u,d as e,t as f,a2 as a,w as o,ab as Z,f as w,g as D,a4 as ee,E as te,j as $,i as I,ad as se,a3 as L,ae,a7 as oe,p as ne,k as le}from"./index-c90bc775.js";import{c as ie,E as ce}from"./el-select-a179422f.js";/* empty css                 */import{b as re,a as de}from"./el-table-column-4764927e.js";import{k as N}from"./challenge-e8d85911.js";import{f as V}from"./tool-bfaf8bdc.js";import{E as ue}from"./el-loading-4ef5b790.js";import"./strings-c1304485.js";import"./isEqual-44e6bdeb.js";import"./_initCloneObject-d01ac546.js";import"./index-066c6226.js";import"./flatten-c41bc7f7.js";/* empty css                   */const l=m=>(ne("data-v-95ce6a27"),m=m(),le(),m),he={class:"container"},_e={class:"title mb24"},pe={class:"flex-between mb16"},ge={class:"flex-center"},fe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Search"})],-1)),me=l(()=>e("svg",{class:"icon mr8","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),ke={class:"icon mr8","aria-hidden":"true",style:{"font-size":"12px"}},be=l(()=>e("use",{"xlink:href":"#icon-chuangjian"},null,-1)),ve=[be],Ce={class:"expand-panel"},$e=l(()=>e("div",{class:"title mb16"},"Challenge Tracks：",-1)),ye=["innerHTML"],xe={class:"flex"},Te=["onClick"],Se=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-bianji"})],-1)),Ee=[Se],ze=["onClick"],we=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),De=[we],Ie=["onClick"],Le={key:0,class:"round-status success"},Ne=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Ve=[Ne],Be={key:1,class:"round-status error"},je=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Me=[je],qe={key:0,class:"round-status success"},He=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Ke=[He],Ue={key:1,class:"round-status error"},Ae=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Pe=[Ae],Re={key:0,class:"round-status success"},Fe=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Oe=[Fe],Ge={key:1,class:"round-status error"},Je=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-qingchu"})],-1)),Qe=[Je],We={class:"flex"},Xe=["onClick"],Ye=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-bianji"})],-1)),Ze=[Ye],et=["onClick"],tt=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-HostedChallenge"})],-1)),st=[tt],at=["onClick"],ot=l(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-Delete"})],-1)),nt=[ot],lt={__name:"Index",setup(m){const{t:y}=J(),k=Q(),B=()=>{k.push("/host/challenge/add")};W(()=>{p()});const C=v(""),x=v([]),d=X({total:0,pageNum:1,pageSize:10}),T=()=>{d.pageNum=1,p()},b=v([]),j=t=>{b.value=t},S=v(),M=()=>{S.value.clearSelection()},p=()=>{const t=ue.service();Y("all","all","all",{page:d.pageNum,title:C.value}).then(n=>{let h=n.results||[];h.forEach(_=>{_.trackList=[],_.loadTracks=!1}),x.value=h,d.total=n.count}).finally(n=>{t.close()})},q=t=>{k.push(`/host/challenge/edit/${t.id}`)},H=t=>{k.push(`/host/track/add/${t.id}`)},K=t=>{se(t.id).then(n=>{L.success(y("host.deleteSuccess")),p()})},U=()=>{},A=(t,n)=>{k.push(`/host/track/edit/${t.id}/${n.id}`)},P=(t,n)=>{ae(t.id,n.id).then(h=>{L.success(y("host.trackDeleteSuccess")),N(t.id).then(_=>{t.trackList=_.results||[],t.loadTracks=!0})})},R=(t,n)=>{t.loadTracks||N(t.id).then(h=>{t.trackList=h.results||[],t.loadTracks=!0})};return(t,n)=>{const h=ee,_=ie,E=te,i=de,g=oe,z=re,F=ce;return r(),u("div",he,[e("div",_e,f(t.$t("host.ChallList")),1),e("div",pe,[e("div",ge,[a(h,{modelValue:C.value,"onUpdate:modelValue":n[0]||(n[0]=s=>C.value=s),placeholder:t.$t("search"),clearable:"",style:{width:"240px"},onKeyup:Z(T,["enter"]),onClear:T},{prefix:o(()=>[fe]),_:1},8,["modelValue","placeholder","onKeyup"]),b.value.length>0?(r(),w(_,{key:0,class:"ml16 custom-selected-tag",size:"large",type:"info",closable:"",style:{"border-radius":"3px"},onClose:M},{default:o(()=>[$(" 已选择"+f(b.value.length)+"项 ",1)]),_:1})):D("",!0),b.value.length>0?(r(),w(E,{key:1,type:"danger",class:"ml16",onClick:n[1]||(n[1]=s=>U())},{default:o(()=>[me,$(" 批量删除 ")]),_:1})):D("",!0)]),a(E,{type:"primary",class:"ml16",onClick:B},{default:o(()=>[(r(),u("svg",ke,ve)),$(" "+f(t.$t("addChall.createChall")),1)]),_:1})]),a(z,{data:x.value,stripe:"",style:{width:"100%"},ref_key:"multipleTableRef",ref:S,"header-cell-class-name":"thBg",onExpandChange:R,"row-key":"id",onSelectionChange:j},{default:o(()=>[a(i,{type:"expand"},{default:o(s=>[e("div",Ce,[$e,a(z,{data:s.row.trackList,"show-header":!1},{default:o(()=>[a(i,{label:"Name",prop:"name",width:"250"}),a(i,{label:"Description",prop:"description"},{default:o(({row:c})=>[e("div",{innerHTML:c.description},null,8,ye)]),_:1}),a(i,{label:t.$t("operate"),width:"100"},{default:o(({row:c})=>[e("div",xe,[a(g,{class:"box-item",effect:"light",content:t.$t("edit"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:O=>A(s.row,c)},Ee,8,Te)]),_:2},1032,["content"]),a(g,{class:"box-item",effect:"light",content:t.$t("delete"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:O=>P(s.row,c)},De,8,ze)]),_:2},1032,["content"])])]),_:2},1032,["label"])]),_:2},1032,["data"])])]),_:1}),a(i,{prop:"id",label:"ID",width:"100"}),a(i,{prop:"title",label:t.$t("host.title")},{default:o(({row:s})=>[e("div",{class:"underline",onClick:c=>t.$router.push(`/host/challenge/${s.id}`)},f(s.title),9,Ie)]),_:1},8,["label"]),a(i,{prop:"start_date",label:t.$t("host.startDate_utc"),formatter:s=>I(V)(s.start_date)},null,8,["label","formatter"]),a(i,{prop:"end_date",label:t.$t("host.endDate_utc"),formatter:s=>I(V)(s.end_date)},null,8,["label","formatter"]),a(i,{prop:"creator",label:t.$t("host.creator"),width:"150"},{default:o(({row:s})=>{var c;return[e("span",null,f((c=s.creator)==null?void 0:c.created_by),1)]}),_:1},8,["label"]),a(i,{prop:"published",label:t.$t("host.publicyAvailable"),width:"150"},{default:o(({row:s})=>[s.published?(r(),u("span",Le,Ve)):(r(),u("span",Be,Me))]),_:1},8,["label"]),a(i,{prop:"is_registration_open",label:t.$t("host.isRegistrationOpen"),width:"150"},{default:o(({row:s})=>[s.is_registration_open?(r(),u("span",qe,Ke)):(r(),u("span",Ue,Pe))]),_:1},8,["label"]),a(i,{prop:"enable_forum",label:t.$t("host.enableForum"),width:"150"},{default:o(({row:s})=>[s.enable_forum?(r(),u("span",Re,Oe)):(r(),u("span",Ge,Qe))]),_:1},8,["label"]),a(i,{label:t.$t("operate"),width:"150"},{default:o(({row:s})=>[e("div",We,[a(g,{class:"box-item",effect:"light",content:t.$t("edit"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>q(s)},Ze,8,Xe)]),_:2},1032,["content"]),a(g,{class:"box-item",effect:"light",content:t.$t("host.createTracks"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>H(s)},st,8,et)]),_:2},1032,["content"]),a(g,{class:"box-item",effect:"light",content:t.$t("delete"),placement:"top-start"},{default:o(()=>[e("span",{class:"icon-button",onClick:c=>K(s)},nt,8,at)]),_:2},1032,["content"])])]),_:1},8,["label"])]),_:1},8,["data"]),a(F,{"hide-on-single-page":"",background:"",layout:"prev, pager, next",total:d.total,"page-size":d.pageSize,"onUpdate:pageSize":n[2]||(n[2]=s=>d.pageSize=s),"current-page":d.pageNum,"onUpdate:currentPage":n[3]||(n[3]=s=>d.pageNum=s),onSizeChange:p,onCurrentChange:p,class:"mt24 oa-pagination"},null,8,["total","page-size","current-page"])])}}},vt=G(lt,[["__scopeId","data-v-95ce6a27"]]);export{vt as default};
